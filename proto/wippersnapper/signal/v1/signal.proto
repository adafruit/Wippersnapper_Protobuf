// SPDX-FileCopyrightText: 2020-2021 Brent Rubell for Adafruit Industries
// SPDX-License-Identifier: MIT
syntax = "proto3";

package wippersnapper.signal.v1;

// Non-WipperSnapper
import "nanopb/nanopb.proto";// WipperSnapper
import "wippersnapper/description/v1/description.proto";
import "wippersnapper/pin/v1/pin.proto";
import "wippersnapper/i2c/v1/i2c.proto";
import "wippersnapper/servo/v1/servo.proto";
import "wippersnapper/pwm/v1/pwm.proto";
import "wippersnapper/ds18x20/v1/ds18x20.proto";
import "wippersnapper/pixels/v1/pixels.proto";
import "wippersnapper/uart/v1/uart.proto";


message BrokerToDevice {
  option (nanopb_msgopt).submsg_callback = true;
  oneof payload {
    // TODO: Leaving pin.proto out as it'll be refactored
    // TODO: try "add/remove"
    // description.proto
    wippersnapper.description.v1.CreateDescription create_description = 1;
    // servo.proto
    wippersnapper.servo.v1.ServoAttach servo_attach = 1;
    wippersnapper.servo.v1.ServoDetach servo_detach = 2;
    wippersnapper.servo.v1.ServoWrite servo_write   = 3;
    // pwm.proto
    wippersnapper.pwm.v1.PWMAttach pwm_attach                        = 2;
    wippersnapper.pwm.v1.PWMDetach pwm_detach                        = 3;
    wippersnapper.pwm.v1.PWMWriteDutyCycle pwm_write_duty            = 4;
    wippersnapper.pwm.v1.PWMWriteDutyCycleMulti pwm_write_duty_multi = 5;
    wippersnapper.pwm.v1.PWMWriteFrequency pwm_write_freq            = 6;
    // pixels.proto
    wippersnapper.pixels.v1.PixelsCreate pixels_create = 7;
    wippersnapper.pixels.v1.PixelsDelete pixels_delete = 8;
    wippersnapper.pixels.v1.PixelsWrite pixels_write   = 9;
    // ds18x20.proto
    wippersnapper.ds18x20.v1.Ds18x20Init ds18x20_init     = 10;
    wippersnapper.ds18x20.v1.Ds18x20DeInit ds18x20_deinit = 11;
    // uart.proto
    wippersnapper.uart.v1.UARTDeviceAttach uart_device_attach = 1;
    // TODO: add uart detach once merged into master
    // i2c.proto
    wippersnapper.i2c.v1.I2CScan i2c_scan = 2;
    wippersnapper.i2c.v1.I2CInits i2c_inits = 7;
    wippersnapper.i2c.v1.I2CDeinit i2c_deinit = 5;
  }
}

message DeviceToBroker {
  option (nanopb_msgopt).submsg_callback = true;
  oneof payload {
    // TODO: move to pins.proto?: This is sent from the device2IO
    // we may be able to get rid of it after removing `CreateDescription`
    bool configuration_complete = 1;
    // servo.proto
    wippersnapper.servo.v1.ServoAdded servo_added = 1;
    // pwm.proto
    wippersnapper.pwm.v1.PWMAdded pwm_added = 1;
    // pixels.proto
    wippersnapper.pixels.v1.PixelsAdded pixels_added = 1;
    // ds18x20.proto
    wippersnapper.ds18x20.v1.Ds18x20Added ds18x20_added = 1;
    wippersnapper.ds18x20.v1.Ds18x20Event ds18x20_event = 2;
    // uart.proto
    wippersnapper.uart.v1.UARTAdded uart_added = 1;
    wippersnapper.uart.v1.UARTEvent uart_event = 2;
    // i2c.proto
    wippersnapper.i2c.v1.I2CScanResponse resp_i2c_scan  = 2;
    wippersnapper.i2c.v1.I2CAdded i2c_added        = 3;
    wippersnapper.i2c.v1.I2CRemoved i2c_removed    = 4;
    wippersnapper.i2c.v1.I2CEvent i2c_event  = 6;
  }
}
